#!/usr/bin/with-contenv bash

log_dir="/vdr/log"
rules_dir="/etc/socklog.rules"


# search for socklog control files
if [ -f "$rules_dir/vdr" ]; then
	cfile_exists="true"
fi


# make folder
if [ ! -d "$log_dir" ]; then
    mkdir -p "$log_dir"
fi


if [ "$LOG2FILE" = "true" ] && [ "$cfile_exists" != "true" ]; then
	echo "Enable: Log to file ($log_dir/*)"
	echo -e "-\n+.*vdr*\w:\n$log_dir" > "$rules_dir/vdr"
elif [ "$cfile_exists" = "true" ]; then
	echo "Disable: Log to file (Log files in '$log_dir/*' will not be deleted\!)"
	rm -rf "$rules_dir/vdr"
fi
